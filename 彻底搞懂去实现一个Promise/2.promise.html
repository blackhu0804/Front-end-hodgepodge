<script type="text/javascript">
	/*
		让其支持同步任务
		在reslove和reject里面用setTimeout进行包裹，使其到then方法执行之后再去执行，这样我们就让promise支持传入同步方法
	*/
	function myPromise(fn) {
        let self = this
        self.value = null // 成功时的值
        self.error = null // 失败的原因
        self.onFulfilled = null // 成功的回调
        self.onRejected = null // 失败的回调

        function resolve(value) {
            setTimeout( () => {
            	self.value = value
            	self.onFulfilled(self.value)
            })
        }

        function reject(error) {
        	setTimeout( () => {
        		self.error = error
        	    self.onRejected(self.error)
        	})    
        }

        fn(resolve, reject)
    }

    myPromise.prototype.then = function(onFulfilled, onRejected) {
        this.onFulfilled = onFulfilled
        this.onRejected = onRejected
    };

    var p = new myPromise( (resolve, reject) => {
        resolve('同步任务执行')
    })

    function resolve(value) {
        console.log(value)
    }

    function reject(error) {
        console.log(error)
    }

    p.then(resolve, reject)
</script>