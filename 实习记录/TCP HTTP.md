# TCP、HTTP

>  TCP 位于传输层,而 HTTP 协议对应于应用层。但是 HTTP 是基于 TCP 协议的。

## TCP
---
### TCP 的三次挥手 和四次握手？
#### 三次握手
> 为什么是三次握手？
> ->三次是保证双方互相明确对方能收能发的最低值。

- 客户端 “喂，你听得到吗？”` A->SYN_SEND`
- 服务端 “我听得到呀，你听得到我吗？” 应答与请求同时发出 `B->SYN_RCVD | A->ESTABLISHED`
- 客户端  “我能听到你，今天balabala……”`B->ESTABLISHED`
#### 四次挥手
- 客户端 “喂，我不说了。” `A->FIN_WAIT1`
- 服务器 “我知道了。等下，上一句还没说完。Balabala…..”`B->CLOSE_WAIT | A->FIN_WAIT2`
- 服务器 ”好了，说完了，我也不说了。”`B->LAST_ACK`
- 客户端 我知道了。`A->TIME_WAIT | B->CLOSED`
- A 等待 2MSL,保证B收到了消息,否则重说一次”我知道了”`A->CLOSED`

### TCP 和 UDP 的区别？
- TCP 协议面向有链接，能正确处理丢包，传输顺序错乱的问题，但是为了建立与断开连接，需要三次握手四次挥手，造成资源浪费。
- UDP 面向无连接，不一定提供可靠性的数据传输。不管对方收没收到，如果要得到通知，需要通过应用层。

## HTTP
> HTTP 是基于 TCP/IP 协议的应用层协议。它不涉及数据包（packet）传输，主要规定了客户端和服务器之间的通信格式，默认使用80端口。
> 当浏览器需要从服务器获取网页数据的时候，会发出一次 HTTP 请求。 HTTP 会通过 TCP 建立起一个到服务器的连接通道，当本次请求需要的数据完毕后， HTTP 会立即将 TCP 连接断开，这个过程是很短的。所以 HTTP 是一种短连接，是一种无状态的链接。

### 状态码
#### 2xx(成功)表示成功处理了请求的状态代码。
- 200 (成功) 服务器已成功处理了请求。 通常，这表示服务器提供了请求的网页。
- 204 (无内容) 服务器成功处理了请求，但没有返回任何内容。
- 205 (重置内容) 服务器成功处理了请求，但没有返回任何内容。
- 206 (部分内容) 服务器成功处理了部分 GET 请求。

#### 3xx(重定向) 表示要完成请求，需要进一步操作。
- 301 永久性重定向，表示资源已分配到新的URL,使得搜索引擎在抓取新内容的同时将旧的网址替换成重定向后的网址。  
- 302 临时性重定向，表示资源临时被分配到新的URL，使得搜索引擎抓取新内容保留旧的网址。
- 303 (查看其他位置) 请求者应当对不同的位置使用单独的 GET 请求来检索响应时，服务器返回此代码。
- 304 (未修改) 自从上次请求后，请求的网页未修改过。 服务器返回此响应时，不会返回网页内容。表示有缓存，读取缓存内容，加上`Pragma: no-cache`不会缓存
- 307 (临时重定向) 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求。

##### 适用场景
- 301：域名切换、HTTP 切换到 HTTPS
- 302：未登录用户访问个人中心时重定向到登录页面、404页面提示后跳转到首页

#### 4xx(请求错误)
- 400 bad request，请求报文存在语法错误
- 401 unauthorized，表示发送的请求需要有通过 HTTP 认证的认证信息
- 403 forbidden，表示对请求资源的访问被服务器拒绝
- 404 not found，表示在服务器上没有找到请求的资源


#### 5xx(服务器错误)
- 500 internal sever error，表示服务器端在执行请求时发生了错误
- 503 service unavailable，表明服务器暂时处于超负载或正在停机维护，无法处理请求

### HTTP,HTTPS的区别

1. HTTPS协议需要CA申请证书，免费的较少，一般需要一定费用
2. HTTP是超文本传输协议，信息是明文传输，通过抓包可以获取传输的信息，HTTPS是具有安全性的ssl加密传输协议，数据加密传输。
3. HTTPS端口是443，HTTP端口是80
4. HTTP的连接是无状态的，HTTPS协议时由SSL+HTTP协议构建的可进行加密传输，身份认证的网络协议，比HTTP协议更安全。